<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>nwfscDiscard • nwfscDiscard</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="nwfscDiscard">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">nwfscDiscard</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/nwfscDiscard.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>nwfscDiscard</h1>
                        <h4 data-toc-skip class="author">Chantel
Wetzel</h4>
            
            <h4 data-toc-skip class="date">2024-11-15</h4>
      

      <div class="hidden name"><code>nwfscDiscard.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <strong>nwfscDiscard</strong> package was written by scientists
at the Northwest Fisheries Science Center (NWFSC) to explore and process
West Coast Groundfish Observer Program (WCGOP) data. This package can be
used to process WCGOP data for West Coast groundfish assessments.</p>
</div>
<div class="section level2">
<h2 id="use">Use<a class="anchor" aria-label="anchor" href="#use"></a>
</h2>
<p><strong>nwfscDiscard</strong> can be used to:</p>
<ul>
<li><p>Ensure confidentiality is met based on the requested
stratification of data by gear and area.</p></li>
<li><p>Summarize observed discard rates by gear and area for catch share
and non- catch share vessels.</p></li>
<li><p>Summarize biological data from observed discards for use in
groundfish stock assessments.</p></li>
<li><p>Visualize data.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="functions">Functions<a class="anchor" aria-label="anchor" href="#functions"></a>
</h2>
<p>A list of all functions in the packages can be viewed by:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="st">"package:nwfscDiscard"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<div class="section level3">
<h3 id="defining-data-structure">Defining Data Structure<a class="anchor" aria-label="anchor" href="#defining-data-structure"></a>
</h3>
<p>The code combines the data into fleet structures requested by users
based on gear and areas. The gear and area grouping are passed to all of
the processing functions:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Gears to keep and how they should be grouped within a list:</span></span>
<span><span class="va">gear_groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Bottom Trawl"</span>, <span class="st">"Midwater Trawl"</span>, <span class="st">"Shrimp Trawl"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Hook &amp; Line"</span>, <span class="st">"Pot"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">gear_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"trawl"</span>, <span class="st">"fixed gear"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fleet areas:</span></span>
<span><span class="va">fleet_groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"WA"</span>, <span class="st">"OR"</span>, <span class="st">"CA"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">fleet_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"coastwide"</span><span class="op">)</span></span></code></pre></div>
<p>where the above code groups the data into two coastwide fleets based
upon gear types. The data can be grouped by state or by latitude. The
WCGOP data contains both a departure and return states. Generally, the
return state is used to group data based on state areas. If the data
area being grouped by latitude this can be done by using the latitude of
the set (SET_LAT), the average latitude across a set (AVG_LAT), or by
the latitude that the gear was retreived (UP_LAT). If the data needs to
be split north and south of 40 10 N. latitude, the WCGOP data contains a
field that specifies north or south based on the average latitude
(AREA). Since the data can be split across various fields (state or
latitude) the column name to specify the grouping needs to be
specified:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fleet_colname</span> <span class="op">=</span> <span class="st">"r_state"</span></span></code></pre></div>
<p>where the above example groups the data based on the return state.
The fleet column name should be a column in the data.</p>
<p>Once the grouping has been specified, the data are checked to ensure
the grouping can meet confidentiality rules. This check based on all the
data within the specified grouping, not just the observations of a
particular species.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ci</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/check_confidential.html">check_confidential</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">catch</span>,</span>
<span>  gear_groups <span class="op">=</span> <span class="va">gear_groups</span>,</span>
<span>  gear_names <span class="op">=</span> <span class="va">gear_names</span>,</span>
<span>  fleet_colname <span class="op">=</span> <span class="va">fleet_colname</span>,</span>
<span>  fleet_groups <span class="op">=</span> <span class="va">fleet_groups</span>,</span>
<span>  fleet_names <span class="op">=</span> <span class="va">fleet_names</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="biological-data">Biological Data<a class="anchor" aria-label="anchor" href="#biological-data"></a>
</h3>
<p>The length and or age compositions of discarded fish can be the
processed for use in assessment.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bio_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_biological_data.html">get_biological_data</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">biological_data</span>,</span>
<span>  catch_data <span class="op">=</span> <span class="va">catch_data</span>,</span>
<span>  species <span class="op">=</span> <span class="st">"Sablefish"</span>,</span>
<span>  len_bins <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">90</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  age_bins <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">50</span>,</span>
<span>  gear_groups <span class="op">=</span> <span class="va">gear_groups</span>,</span>
<span>  gear_names <span class="op">=</span> <span class="va">gear_names</span>,</span>
<span>  fleet_colname <span class="op">=</span> <span class="va">fleet_colname</span>,</span>
<span>  fleet_groups <span class="op">=</span> <span class="va">fleet_groups</span>,</span>
<span>  fleet_names <span class="op">=</span> <span class="va">fleet_names</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>where the species name, length, and age bins need to be provided.</p>
<p>The mean weight of the discarded fish can also be calculated for
using in an assessment:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mean_weight</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_mean_weights.html">get_mean_weights</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">catch_data</span>,</span>
<span>  species <span class="op">=</span> <span class="st">"Sablefish"</span>,</span>
<span>  gear_groups <span class="op">=</span> <span class="va">gear_groups</span>,</span>
<span>  gear_names <span class="op">=</span> <span class="va">gear_names</span>,</span>
<span>  fleet_colname <span class="op">=</span> <span class="va">fleet_colname</span>,</span>
<span>  fleet_groups <span class="op">=</span> <span class="va">fleet_groups</span>,</span>
<span>  fleet_names <span class="op">=</span> <span class="va">fleet_names</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="discard-rates-and-total-observed-discards">Discard Rates and Total Observed Discards<a class="anchor" aria-label="anchor" href="#discard-rates-and-total-observed-discards"></a>
</h3>
<p>The observed catch are then processed for discard rates or totals.
Data from catch share and non-catch share vessels are processed
separately based on attributes of the data. Catch share vessels have 100
percent observer coverage starting in 2011 and are treated as a census
of discarding in the IFQ fishery.<br>
Non-catch share vessels have variable rates of observer coverage and the
discard rates are based on the observed trips. These trips are then
bootstrap to estimate uncertainty around the discard rates.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ob_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/do_discard_bootstrap.html">do_discard_bootstrap</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">catch_data</span>,</span>
<span>  species <span class="op">=</span> <span class="st">"Sablefish"</span>,</span>
<span>  boot_number <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  gear_groups <span class="op">=</span> <span class="va">gear_groups</span>,</span>
<span>  gear_names <span class="op">=</span> <span class="va">gear_names</span>,</span>
<span>  fleet_colname <span class="op">=</span> <span class="va">fleet_colname</span>,</span>
<span>  fleet_groups <span class="op">=</span> <span class="va">fleet_groups</span>,</span>
<span>  fleet_names <span class="op">=</span> <span class="va">fleet_names</span>,</span>
<span>  seed_number <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  rm_em_data <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Additionally, a subset of catch share vessels use electronic
monitoring (EM) rather that have a physical observer onboard for all
trips. These vessels have specific rules about what they can and cannot
be discarded at-sea and which species need to be recorded in the logbook
and/or monitored by video. The EM program manual can be found <a href="https://www.fisheries.noaa.gov/s3/2023-11/2024ElectronicMonitoring-ProgramManual-Updated-November2023.pdf" class="external-link">online</a>
and includes a list of IFQ species. All IFQ species can be discarded at
sea within view of cameras. If appropriate, the discard from EM vessels
can be processed and are treated as a census of discarding. A subset of
trips for vessels that use EM will have a physical onboard observer and
be included in the catch records. If EM discards are processed and added
to the observed non-EM catch share discards, one must exclude the
physical onobard observer data from EM vessels since this would
duplicate records.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">em_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/do_discard_bootstrap.html">do_discard_bootstrap</a></span><span class="op">(</span></span>
<span>  dir <span class="op">=</span> <span class="fu">here</span><span class="fu">::</span><span class="fu">here</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">em_catch_data</span>,</span>
<span>  species <span class="op">=</span> <span class="st">"Sablefish"</span>,</span>
<span>  gear_groups <span class="op">=</span> <span class="va">gear_groups</span>,</span>
<span>  gear_names <span class="op">=</span> <span class="va">gear_names</span>,</span>
<span>  fleet_colname <span class="op">=</span> <span class="va">fleet_colname</span>,</span>
<span>  fleet_groups <span class="op">=</span> <span class="va">fleet_groups</span>,</span>
<span>  fleet_names <span class="op">=</span> <span class="va">fleet_names</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The discard rates from the catch share vessels with onboard observers
and EM observation can be then combined:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/combine_cs_discards.html">combine_cs_discards</a></span><span class="op">(</span></span>
<span>  cs_data <span class="op">=</span> <span class="va">ob_out</span><span class="op">$</span><span class="va">cs</span>,</span>
<span>  em_data <span class="op">=</span> <span class="va">em_out</span><span class="op">$</span><span class="va">em</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="visualizing-the-data">Visualizing the Data<a class="anchor" aria-label="anchor" href="#visualizing-the-data"></a>
</h3>
<p>Currently, there are a couple of functions that provide summaries and
plots of the data to help users. The first is a function that pull data
from the GEMM which has expanded catches based on the retained and
discard observations by WCGOP. The catch by sector is then summarized by
sectors that are catch shares or non-catch shares. This information
could be used to better inform how the rates between the groups could be
combined for use in an assessment (e.g., are the majority of catches
occurring by catch share vessels?).</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gemm</span> <span class="op">&lt;-</span> <span class="fu">nwfscSurvey</span><span class="op">(</span>common_name <span class="op">=</span> <span class="st">"Sablefish"</span><span class="op">)</span></span>
<span><span class="va">gemm_check</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_prop_gemm_catch.html">calc_prop_gemm_catch</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">gemm</span>,</span>
<span>  species <span class="op">=</span> <span class="st">"Sablefish"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Visualize the discard length or ages by gear type or catch share
vs. non-catch shares:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wcgop_bio</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_wcgop_bio.html">plot_wcgop_bio</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">biological_data</span>,</span>
<span>  species <span class="op">=</span> <span class="st">"Sablefish"</span>,</span>
<span>  plot <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,</span>
<span>  comp_column <span class="op">=</span> <span class="st">"length"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Chantel R. Wetzel, Allan C. Hicks.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
